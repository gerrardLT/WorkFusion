# Agentic RAG ä¼˜åŒ–æ–¹æ¡ˆå¯¹æ¯”è¯„ä¼°æŠ¥å‘Š

> **è¯„ä¼°ç›®æ ‡**: å¯¹æ¯”å½“å‰é¡¹ç›®å®ç°ä¸ã€ŠAgentic RAG å®Œæ•´å®ç°æŒ‡å—ã€‹ï¼Œè¯†åˆ«å·®è·ä¸ä¼˜åŒ–æœºä¼š
>
> **é¡¹ç›®åç§°**: å¤šåœºæ™¯ AI çŸ¥è¯†é—®ç­”ç³»ç»Ÿï¼ˆStock-RAG-Systemï¼‰
>
> **è¯„ä¼°æ—¶é—´**: 2025-09-30
>
> **è¯„ä¼°æ–¹æ³•**: é€æ¨¡å—å¯¹æ¯”åˆ†æï¼Œè¯„ä¼°æŠ€æœ¯å·®è·ã€å®æ–½éš¾åº¦ã€ä»·å€¼æ”¶ç›Š

---

## ğŸ“Š æ‰§è¡Œæ‘˜è¦

### å½“å‰ç³»ç»Ÿæ¦‚å†µ

| ç»´åº¦ | å½“å‰çŠ¶æ€ | æŠ€æœ¯æˆç†Ÿåº¦ |
|-----|---------|----------|
| **æ¶æ„æ¨¡å¼** | æ··åˆ RAG (BM25 + FAISS) | â­â­â­â­ æˆç†Ÿ |
| **æ£€ç´¢ç­–ç•¥** | é™æ€å‘é‡åŒ¹é… + å…³é”®è¯æ£€ç´¢ | â­â­â­ æ ‡å‡† |
| **é—®ç­”ç”Ÿæˆ** | å•è½®ç›´æ¥ç”Ÿæˆ | â­â­â­ åŸºç¡€ |
| **æˆæœ¬æ§åˆ¶** | æ— ç¼“å­˜ï¼Œæ— æˆæœ¬ä¼˜åŒ– | â­ ç¼ºå¤± |
| **ç­”æ¡ˆéªŒè¯** | æ— éªŒè¯æœºåˆ¶ | â­ ç¼ºå¤± |
| **å¤šè½®å¯¹è¯** | ä¸æ”¯æŒ | â­ ç¼ºå¤± |
| **å¯æ‰©å±•æ€§** | å•æœº FAISSï¼Œæ— åˆ†å¸ƒå¼ | â­â­ æœ‰é™ |

### ä¼˜åŒ–æ½œåŠ›è¯„ä¼°

| ä¼˜åŒ–æ–¹å‘ | é¢„æœŸæå‡ | å®æ–½éš¾åº¦ | ä¼˜å…ˆçº§ | ROI |
|---------|---------|---------|--------|-----|
| **åˆ†å±‚å¯¼èˆªæ£€ç´¢** | å‡†ç¡®ç‡ +10-15% | ğŸŸ¡ ä¸­ | P0 | â­â­â­â­â­ |
| **æ™ºèƒ½ç¼“å­˜** | æˆæœ¬ -60%ï¼Œé€Ÿåº¦ +3x | ğŸŸ¢ ä½ | P0 | â­â­â­â­â­ |
| **ç­”æ¡ˆéªŒè¯** | ä¿¡ä»»åº¦ +50% | ğŸŸ¡ ä¸­ | P0 | â­â­â­â­ |
| **æ™ºèƒ½è·¯ç”±** | å‡†ç¡®ç‡ +8-12% | ğŸ”´ é«˜ | P1 | â­â­â­â­ |
| **å¤šè½®å¯¹è¯** | ç”¨æˆ·ä½“éªŒ +40% | ğŸŸ¡ ä¸­ | P1 | â­â­â­â­ |
| **åˆ†å¸ƒå¼æ¶æ„** | å¹¶å‘ +10x | ğŸ”´ é«˜ | P2 | â­â­â­ |

---

## ğŸ” è¯¦ç»†å¯¹æ¯”åˆ†æ

## 1ï¸âƒ£ æ–‡æ¡£æ£€ç´¢ç­–ç•¥å¯¹æ¯”

### å½“å‰å®ç° (src/pipeline.py + src/questions_processing.py)

```python
# å½“å‰æ£€ç´¢æµç¨‹ï¼ˆç®€åŒ–ï¼‰
class Pipeline:
    def retrieve_documents(self, query: str):
        # 1. BM25 æ£€ç´¢
        bm25_results = self.bm25_index.get_scores(query)

        # 2. å‘é‡æ£€ç´¢
        query_vector = self.get_embedding(query)
        vector_results = self.faiss_index.search(query_vector, k=10)

        # 3. ç®€å•åˆå¹¶
        combined = self.merge_results(bm25_results, vector_results)

        return combined[:5]  # è¿”å›å‰ 5 ä¸ªç»“æœ
```

**ç‰¹ç‚¹**:
- âœ… æ··åˆæ£€ç´¢ï¼ˆBM25 + FAISSï¼‰å·²å®ç°
- âœ… æ”¯æŒå¤šåœºæ™¯ï¼ˆscenario_idï¼‰
- âŒ **é™æ€åŒ¹é…**ï¼šä¸€æ¬¡æ€§æ£€ç´¢å›ºå®šæ•°é‡çš„æ–‡æ¡£å—
- âŒ **æ— åˆ†å±‚ç­–ç•¥**ï¼šå¯¹é•¿æ–‡æ¡£ï¼ˆ100+ é¡µï¼‰æ— ç‰¹æ®Šå¤„ç†
- âŒ **æ— åŠ¨æ€è°ƒæ•´**ï¼šä¸èƒ½æ ¹æ®æ–‡æ¡£å¤§å°è°ƒæ•´ç­–ç•¥

### Agentic RAG æ–¹æ¡ˆ

```python
# åˆ†å±‚å¯¼èˆªç­–ç•¥ï¼ˆæŒ‡å—ç¬¬ 3.2 èŠ‚ï¼‰
class ChunkNavigator:
    def navigate(self, text: str, question: str, max_rounds=3):
        # ç¬¬ä¸€è½®ï¼šç²—ç­›ï¼ˆ20 å¤§å—ï¼‰
        chunks = split_into_chunks(text, n=20)
        scratchpad = f"å¼€å§‹æœç´¢ï¼š{question}"

        for round in range(max_rounds):
            # ä½¿ç”¨ LLM é€‰æ‹©ç›¸å…³å—
            selected = select_relevant_chunks(chunks, question, scratchpad)

            # æ£€æŸ¥ token æ€»é‡
            total_tokens = count_tokens(selected)
            if total_tokens < 2000:
                break  # è¶³å¤Ÿå°ï¼Œåœæ­¢ç»†åˆ†

            # ç»§ç»­ç»†åˆ†
            chunks = [split_into_chunks(c, n=5) for c in selected]
            scratchpad += f"\nç¬¬{round+1}è½®ï¼šæ‰¾åˆ°{len(chunks)}ä¸ªç›¸å…³æ®µè½"

        return selected
```

**æ ¸å¿ƒå·®å¼‚**:
| ç»´åº¦ | å½“å‰å®ç° | Agentic RAG | å·®è· |
|-----|---------|------------|------|
| **æ£€ç´¢è½®æ¬¡** | 1 è½®é™æ€ | 3 è½®è¿­ä»£ | âŒ ç¼ºå¤± |
| **åˆ†å—ç²’åº¦** | å›ºå®šå¤§å° | åŠ¨æ€è°ƒæ•´ | âŒ ç¼ºå¤± |
| **ä¸Šä¸‹æ–‡å®Œæ•´æ€§** | å¯èƒ½åˆ‡ç¢ | ä¿æŒå®Œæ•´ | âŒ é—®é¢˜ |
| **LLM å‚ä¸å†³ç­–** | æ—  | æ¯è½®ç­›é€‰ | âŒ ç¼ºå¤± |

### å·®è·è¯„ä¼°

**ğŸ”´ å…³é”®é—®é¢˜**:
1. **é•¿æ–‡æ¡£å¤„ç†èƒ½åŠ›ä¸è¶³**: å½“å‰å¯¹ 100+ é¡µçš„æŠ•ç ”æŠ¥å‘Šï¼Œå¯èƒ½æ£€ç´¢åˆ°ç¢ç‰‡åŒ–ä¿¡æ¯
2. **ä¸Šä¸‹æ–‡æ–­è£‚é£é™©**: å›ºå®šå¤§å°åˆ†å—å¯èƒ½åˆ‡ç¢å®Œæ•´æ¡æ¬¾ï¼ˆå¦‚è´¢åŠ¡æŠ¥è¡¨ã€é£é™©æç¤ºç­‰ï¼‰
3. **æ— æ™ºèƒ½ç­›é€‰**: ä¸èƒ½æ ¹æ®é—®é¢˜åŠ¨æ€è°ƒæ•´æ£€ç´¢ç²’åº¦

**ğŸ’¡ ä¼˜åŒ–å»ºè®®**:
```python
# å»ºè®®ï¼šåœ¨ Pipeline ä¸­æ·»åŠ æ–‡æ¡£å¤§å°åˆ¤æ–­
class Pipeline:
    def retrieve_documents(self, query: str, document_size: int):
        if document_size < 5000:  # å°æ–‡æ¡£
            return self._standard_retrieval(query)
        elif document_size < 50000:  # ä¸­æ–‡æ¡£
            return self._hierarchical_retrieval(query, max_rounds=2)
        else:  # å¤§æ–‡æ¡£
            return self._full_agentic_retrieval(query, max_rounds=3)
```

**å®æ–½ä¼˜å…ˆçº§**: ğŸ”´ **P0 - é«˜ä¼˜å…ˆçº§**

**ç†ç”±**: æŠ•ç ”æŠ¥å‘Šé€šå¸¸ 50-200 é¡µï¼Œå½“å‰é™æ€æ£€ç´¢éš¾ä»¥å‡†ç¡®å®šä½è·¨é¡µä¿¡æ¯ã€‚

---

## 2ï¸âƒ£ æ™ºèƒ½è·¯ç”±ä»£ç†å¯¹æ¯”

### å½“å‰å®ç°

```python
# questions_processing.py - å½“å‰é—®é¢˜åˆ†æ
class QuestionsProcessor:
    def analyze_question(self, question: str):
        # ä½¿ç”¨ LLM åˆ†æé—®é¢˜ç±»å‹ã€éš¾åº¦
        prompt = f"åˆ†æé—®é¢˜ï¼š{question}"
        analysis = self.api_processor.call_llm(prompt)

        # ä½†å¹¶ä¸ç”¨äºæŒ‡å¯¼æ£€ç´¢ç­–ç•¥
        return analysis
```

**ç‰¹ç‚¹**:
- âœ… æœ‰é—®é¢˜åˆ†æèƒ½åŠ›
- âŒ **åˆ†æç»“æœæœªç”¨äºæ£€ç´¢å†³ç­–**ï¼šä»…åšåˆ†ç±»ï¼Œä¸å½±å“æ£€ç´¢ç­–ç•¥
- âŒ **æ— æ–‡æ¡£å—é€‰æ‹©é€»è¾‘**ï¼šä¸èƒ½æ™ºèƒ½é€‰æ‹©å“ªäº›æ–‡æ¡£å—æ›´ç›¸å…³

### Agentic RAG æ–¹æ¡ˆ

```python
# æ™ºèƒ½è·¯ç”±ä»£ç†ï¼ˆæŒ‡å—ç¬¬ 4.1 èŠ‚ï¼‰
class RoutingAgent:
    def route(self, chunks, question, history=""):
        # è®© LLM åˆ†æå¹¶é€‰æ‹©æ–‡æ¡£å—
        previews = [f"å—{i}: {chunk[:100]}..." for i, chunk in enumerate(chunks)]

        prompt = f"""
        é—®é¢˜ï¼š{question}
        å†å²ï¼š{history}
        æ–‡æ¡£å—é¢„è§ˆï¼š{previews}

        é€‰æ‹©æœ€å¯èƒ½åŒ…å«ç­”æ¡ˆçš„å—ï¼Œè¾“å‡º JSONï¼š
        {{
            "reasoning": "æ¨ç†è¿‡ç¨‹",
            "selected_chunks": [0, 3, 4],
            "confidence": 0.9
        }}
        """

        result = self.llm_call(prompt, temperature=0)
        return json.loads(result)
```

**æ ¸å¿ƒå·®å¼‚**:
| ç»´åº¦ | å½“å‰å®ç° | Agentic RAG | å·®è· |
|-----|---------|------------|------|
| **é€‰æ‹©å†³ç­–** | æ— ï¼Œä¾èµ–ç›¸ä¼¼åº¦åˆ†æ•° | LLM æ¨ç†å†³ç­– | âŒ ç¼ºå¤± |
| **å¯è§£é‡Šæ€§** | æ—  | æœ‰æ¨ç†è¿‡ç¨‹ | âŒ ç¼ºå¤± |
| **ç½®ä¿¡åº¦è¯„ä¼°** | æ—  | æœ‰ç½®ä¿¡åº¦åˆ†æ•° | âŒ ç¼ºå¤± |
| **å†å²è®°å½•** | æ—  | é¿å…é‡å¤æœç´¢ | âŒ ç¼ºå¤± |

### å·®è·è¯„ä¼°

**ğŸŸ¡ ä¸­ç­‰é—®é¢˜**:
1. **æ£€ç´¢é»‘ç›’**: ç”¨æˆ·ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ£€ç´¢åˆ°è¿™äº›æ–‡æ¡£
2. **æ— ç½®ä¿¡åº¦**: ç³»ç»Ÿæ— æ³•è¯„ä¼°æ£€ç´¢è´¨é‡
3. **æ— ä¼˜åŒ–åé¦ˆ**: ä¸èƒ½æ ¹æ®å†å²æ”¹è¿›æ£€ç´¢ç­–ç•¥

**ğŸ’¡ ä¼˜åŒ–å»ºè®®**:
```python
# å»ºè®®ï¼šæ·»åŠ è·¯ç”±ä»£ç†å±‚
class Pipeline:
    def __init__(self, ..., enable_routing=False):
        if enable_routing:
            self.routing_agent = RoutingAgent()

    def retrieve_with_routing(self, query: str, chunks: List[str]):
        # ä½¿ç”¨è·¯ç”±ä»£ç†é€‰æ‹©æ–‡æ¡£å—
        route_result = self.routing_agent.route(chunks, query)

        # è¿”å›é€‰ä¸­çš„å— + æ¨ç†è¿‡ç¨‹
        return {
            "chunks": [chunks[i] for i in route_result["selected_chunks"]],
            "reasoning": route_result["reasoning"],
            "confidence": route_result["confidence"]
        }
```

**å®æ–½ä¼˜å…ˆçº§**: ğŸŸ¡ **P1 - ä¸­ä¼˜å…ˆçº§**

**ç†ç”±**: èƒ½æ˜¾è‘—æå‡ç”¨æˆ·ä¿¡ä»»åº¦ï¼Œä½†éœ€è¦é¢å¤–çš„ LLM è°ƒç”¨ï¼ˆæˆæœ¬å¢åŠ  20-30%ï¼‰ã€‚

---

## 3ï¸âƒ£ æˆæœ¬æ§åˆ¶ä¸ç¼“å­˜å¯¹æ¯”

### å½“å‰å®ç°

```python
# api_requests.py - å½“å‰ API è°ƒç”¨
class APIProcessor:
    def get_embeddings(self, texts: List[str]):
        # ç›´æ¥è°ƒç”¨ APIï¼Œæ— ç¼“å­˜
        response = dashscope.TextEmbedding.call(
            model="text-embedding-v3",
            input=texts
        )
        return response.output.embeddings

    def call_llm(self, prompt: str):
        # æ¯æ¬¡éƒ½è°ƒç”¨ API
        response = dashscope.Generation.call(
            model="qwen-turbo-latest",
            prompt=prompt
        )
        return response.output.text
```

**ç‰¹ç‚¹**:
- âœ… API è°ƒç”¨æ­£å¸¸å·¥ä½œ
- âŒ **æ— ä»»ä½•ç¼“å­˜**ï¼šç›¸åŒé—®é¢˜é‡å¤æŸ¥è¯¢ï¼Œæµªè´¹æˆæœ¬
- âŒ **æ— æˆæœ¬ç›‘æ§**ï¼šä¸çŸ¥é“æ¯æ¬¡æŸ¥è¯¢èŠ±è´¹å¤šå°‘
- âŒ **æ— åˆ†å±‚ç­–ç•¥**ï¼šæ‰€æœ‰æŸ¥è¯¢ç”¨ç›¸åŒæ¨¡å‹

### Agentic RAG æ–¹æ¡ˆ

```python
# åŒå±‚ç¼“å­˜ + åˆ†å±‚è°ƒç”¨ï¼ˆæŒ‡å—ç¬¬ 4.2ã€4.4 èŠ‚ï¼‰
class SmartCache:
    def get(self, question: str):
        # 1. ç²¾ç¡®ç¼“å­˜
        if question in self.exact_cache:
            return self.exact_cache[question]

        # 2. è¯­ä¹‰ç¼“å­˜
        question_emb = self.get_embedding(question)
        for cache_emb, (cache_q, cache_ans) in self.semantic_cache.items():
            sim = cosine_similarity(question_emb, cache_emb)
            if sim > 0.95:  # é«˜ç›¸ä¼¼åº¦
                return cache_ans

        return None

class CostOptimizer:
    def select_strategy(self, doc_size: int):
        if doc_size < 5000:
            return "direct_rag"  # ç›´æ¥ç”¨ qwen-max
        elif doc_size < 50000:
            return "hybrid_rag"  # qwen-turbo é¢„ç­›é€‰ + qwen-max
        else:
            return "full_agentic"  # å®Œæ•´æµç¨‹
```

**æ ¸å¿ƒå·®å¼‚**:
| ç»´åº¦ | å½“å‰å®ç° | Agentic RAG | å·®è· |
|-----|---------|------------|------|
| **ç²¾ç¡®ç¼“å­˜** | æ—  | æœ‰ | âŒ ç¼ºå¤± |
| **è¯­ä¹‰ç¼“å­˜** | æ—  | æœ‰ | âŒ ç¼ºå¤± |
| **åˆ†å±‚è°ƒç”¨** | æ—  | æœ‰ | âŒ ç¼ºå¤± |
| **æˆæœ¬ç›‘æ§** | æ—  | æœ‰ | âŒ ç¼ºå¤± |
| **é¢„è®¡èŠ‚çœ** | 0% | 60%+ | âŒ å·¨å¤§å·®è· |

### å·®è·è¯„ä¼°

**ğŸ”´ ä¸¥é‡é—®é¢˜**:
1. **æˆæœ¬ä¸å¯æ§**: é«˜é¢‘æŸ¥è¯¢åœºæ™¯ä¸‹ï¼ŒAPI è´¹ç”¨å¯èƒ½å¿«é€Ÿå¢é•¿
2. **å“åº”é€Ÿåº¦æ…¢**: æ— ç¼“å­˜å¯¼è‡´æ¯æ¬¡éƒ½è¦ç­‰å¾… API è°ƒç”¨ï¼ˆ2-5ç§’ï¼‰
3. **èµ„æºæµªè´¹**: ç›¸ä¼¼é—®é¢˜é‡å¤è®¡ç®—

**ğŸ’¡ ä¼˜åŒ–å»ºè®®**:
```python
# å»ºè®®ï¼šæ·»åŠ ç¼“å­˜å±‚ï¼ˆæœ€å®¹æ˜“å®ç°ï¼Œæ”¶ç›Šæœ€å¤§ï¼‰
class Pipeline:
    def __init__(self, ..., enable_cache=True):
        if enable_cache:
            self.cache = SmartCache(redis_url="redis://localhost:6379")

    def ask_question(self, question: str):
        # 1. å…ˆæŸ¥ç¼“å­˜
        cached_answer = self.cache.get(question)
        if cached_answer:
            logger.info("ç¼“å­˜å‘½ä¸­ï¼Œç›´æ¥è¿”å›")
            return cached_answer

        # 2. æ— ç¼“å­˜åˆ™æ­£å¸¸å¤„ç†
        answer = self._process_question(question)

        # 3. å­˜å…¥ç¼“å­˜
        self.cache.set(question, answer, ttl=3600)  # 1å°æ—¶è¿‡æœŸ

        return answer
```

**å®æ–½ä¼˜å…ˆçº§**: ğŸ”´ **P0 - æœ€é«˜ä¼˜å…ˆçº§**

**ç†ç”±**:
- å®æ–½éš¾åº¦ä½ï¼ˆ1-2å¤©ï¼‰
- æ”¶ç›Šå·¨å¤§ï¼ˆæˆæœ¬ -60%ï¼Œé€Ÿåº¦ +3xï¼‰
- æ— é£é™©ï¼ˆç‹¬ç«‹æ¨¡å—ï¼Œä¸å½±å“æ ¸å¿ƒé€»è¾‘ï¼‰

**é¢„æœŸæ•ˆæœ**:
```
å‡è®¾æ¯æœˆ 10,000 æ¬¡æŸ¥è¯¢
- ç¼“å­˜å‰ï¼š10,000 æ¬¡ Ã— Â¥0.05/æ¬¡ = Â¥500
- ç¼“å­˜åï¼š4,000 æ¬¡ Ã— Â¥0.05/æ¬¡ = Â¥200ï¼ˆ60% å‘½ä¸­ç‡ï¼‰
- èŠ‚çœï¼šÂ¥300/æœˆï¼ˆ60%ï¼‰
```

---

## 4ï¸âƒ£ ç­”æ¡ˆéªŒè¯ä¸å¹»è§‰æ§åˆ¶å¯¹æ¯”

### å½“å‰å®ç°

```python
# questions_processing.py - å½“å‰ç­”æ¡ˆç”Ÿæˆ
class QuestionsProcessor:
    def generate_answer(self, question: str, context: str):
        prompt = f"""
        é—®é¢˜ï¼š{question}
        ä¸Šä¸‹æ–‡ï¼š{context}

        è¯·å›ç­”é—®é¢˜ã€‚
        """

        answer = self.api_processor.call_llm(prompt)

        # ç›´æ¥è¿”å›ï¼Œæ— éªŒè¯
        return answer
```

**ç‰¹ç‚¹**:
- âœ… èƒ½ç”Ÿæˆç­”æ¡ˆ
- âŒ **æ— å¼•ç”¨éªŒè¯**ï¼šä¸æ£€æŸ¥ç­”æ¡ˆä¸­çš„å¼•ç”¨æ˜¯å¦çœŸå®å­˜åœ¨
- âŒ **æ— å¹»è§‰æ£€æµ‹**ï¼šLLM å¯èƒ½ç¼–é€ ä¸å­˜åœ¨çš„å†…å®¹
- âŒ **æ— ç½®ä¿¡åº¦è¯„ä¼°**ï¼šä¸çŸ¥é“ç­”æ¡ˆçš„å¯ä¿¡åº¦

**å®é™…é£é™©ç¤ºä¾‹**:
```
é—®é¢˜ï¼š"ä¸­èŠ¯å›½é™… 2023 å¹´ç¬¬ä¸‰å­£åº¦è¥æ”¶æ˜¯å¤šå°‘ï¼Ÿ"
ç­”æ¡ˆï¼š"æ ¹æ®ç¬¬ 15 é¡µè´¢æŠ¥ï¼Œè¥æ”¶ä¸º 5.2 äº¿ç¾å…ƒã€‚"

é£é™©ï¼šæ–‡æ¡£åªæœ‰ 10 é¡µï¼Œç¬¬ 15 é¡µä¸å­˜åœ¨ï¼
```

### Agentic RAG æ–¹æ¡ˆ

```python
# ç­”æ¡ˆéªŒè¯å™¨ï¼ˆæŒ‡å—ç¬¬ 4.3 èŠ‚ï¼‰
class AnswerValidator:
    def verify_answer(self, answer: str, source_chunks: List[str]):
        # 1. æå–å¼•ç”¨
        citations = self._extract_citations(answer)  # å¦‚"ç¬¬15é¡µ"

        # 2. æ£€æŸ¥å¼•ç”¨å­˜åœ¨æ€§
        for citation in citations:
            if not self._citation_exists(citation, source_chunks):
                return False, f"è™šå‡å¼•ç”¨: {citation}"

        # 3. LLM äº¤å‰éªŒè¯
        verify_prompt = f"""
        åˆ¤æ–­ç­”æ¡ˆæ˜¯å¦å®Œå…¨åŸºäºæºæ–‡æ¡£ï¼Œæ— ç¼–é€ å†…å®¹ã€‚
        ç­”æ¡ˆï¼š{answer}
        æºæ–‡æ¡£ï¼š{source_chunks}
        ä»…è¿”å›"æœ‰æ•ˆ"æˆ–"æ— æ•ˆ"åŠç†ç”±ã€‚
        """

        validation = self.llm_call(verify_prompt)

        return "æœ‰æ•ˆ" in validation, validation
```

**æ ¸å¿ƒå·®å¼‚**:
| ç»´åº¦ | å½“å‰å®ç° | Agentic RAG | å·®è· |
|-----|---------|------------|------|
| **å¼•ç”¨æ£€æŸ¥** | æ—  | æ­£åˆ™æå– + éªŒè¯ | âŒ ç¼ºå¤± |
| **äº¤å‰éªŒè¯** | æ—  | LLM äºŒæ¬¡ç¡®è®¤ | âŒ ç¼ºå¤± |
| **ç½®ä¿¡åº¦è¯„ä¼°** | æ—  | æœ‰è¯„åˆ†æœºåˆ¶ | âŒ ç¼ºå¤± |
| **é”™è¯¯æç¤º** | æ—  | æ˜ç¡®è­¦å‘Šç”¨æˆ· | âŒ ç¼ºå¤± |

### å·®è·è¯„ä¼°

**ğŸ”´ ä¸¥é‡é—®é¢˜**:
1. **ä¿¡ä»»åº¦é£é™©**: ç”¨æˆ·æ— æ³•åˆ¤æ–­ç­”æ¡ˆæ˜¯å¦å¯ä¿¡
2. **å¹»è§‰é—®é¢˜**: ç‰¹åˆ«æ˜¯è´¢åŠ¡æ•°æ®ã€æ—¥æœŸç­‰ç²¾ç¡®ä¿¡æ¯ï¼Œæ˜“å‡ºé”™
3. **æ³•å¾‹é£é™©**: é‡‘èé¢†åŸŸé”™è¯¯ä¿¡æ¯å¯èƒ½å¯¼è‡´æŠ•èµ„æŸå¤±

**ğŸ’¡ ä¼˜åŒ–å»ºè®®**:
```python
# å»ºè®®ï¼šæ·»åŠ ç­”æ¡ˆéªŒè¯å±‚
class QuestionsProcessor:
    def __init__(self, ..., enable_validation=True):
        if enable_validation:
            self.validator = AnswerValidator()

    def generate_answer(self, question: str, context: str, source_chunks: List[str]):
        # ç”Ÿæˆç­”æ¡ˆ
        answer = self._generate_raw_answer(question, context)

        # éªŒè¯ç­”æ¡ˆ
        is_valid, validation_msg = self.validator.verify_answer(answer, source_chunks)

        if not is_valid:
            # ç­”æ¡ˆæœ‰é—®é¢˜ï¼Œè¿”å›è­¦å‘Š
            return {
                "answer": answer,
                "warning": f"âš ï¸ ç­”æ¡ˆå¯èƒ½ä¸å‡†ç¡®ï¼š{validation_msg}",
                "confidence": "low"
            }

        return {
            "answer": answer,
            "confidence": "high",
            "validation": validation_msg
        }
```

**å®æ–½ä¼˜å…ˆçº§**: ğŸ”´ **P0 - é«˜ä¼˜å…ˆçº§**

**ç†ç”±**: é‡‘èæŠ•ç ”åœºæ™¯å¯¹å‡†ç¡®æ€§è¦æ±‚æé«˜ï¼Œè™šå‡ä¿¡æ¯é£é™©ä¸å¯æ¥å—ã€‚

---

## 5ï¸âƒ£ å¤šè½®å¯¹è¯æ”¯æŒå¯¹æ¯”

### å½“å‰å®ç°

```python
# backend/api/chat.py - å½“å‰é—®ç­”æ¥å£
@app.post("/chat/ask")
async def ask_question(request: QuestionRequest):
    # æ¯æ¬¡éƒ½æ˜¯æ–°çš„ç‹¬ç«‹é—®é¢˜
    answer = processor.process_question(request.question)
    return answer
```

**ç‰¹ç‚¹**:
- âœ… å•è½®é—®ç­”æ­£å¸¸å·¥ä½œ
- âŒ **æ— å¯¹è¯å†å²**ï¼šæ¯æ¬¡æé—®éƒ½æ˜¯å…¨æ–°çš„ï¼Œä¸è®°å½•ä¸Šä¸‹æ–‡
- âŒ **æ— ä»£è¯æŒ‡ä»£å¤„ç†**ï¼šæ— æ³•ç†è§£"é‚£"ã€"å®ƒ"ç­‰ä»£è¯

**å®é™…é—®é¢˜ç¤ºä¾‹**:
```
ç”¨æˆ·: "ä¸­èŠ¯å›½é™… 2023 å¹´è¥æ”¶æ˜¯å¤šå°‘ï¼Ÿ"
ç³»ç»Ÿ: "è¥æ”¶ä¸º 52 äº¿ç¾å…ƒ"

ç”¨æˆ·: "é‚£åˆ©æ¶¦å‘¢ï¼Ÿ"  â† ç³»ç»Ÿä¸çŸ¥é“"é‚£"æŒ‡ä»£"ä¸­èŠ¯å›½é™… 2023 å¹´"
ç³»ç»Ÿ: "è¯·é—®æ‚¨æŒ‡çš„æ˜¯å“ªä¸ªå…¬å¸çš„åˆ©æ¶¦ï¼Ÿ"  â† ä½“éªŒå¾ˆå·®
```

### Agentic RAG æ–¹æ¡ˆ

```python
# å¯¹è¯è®°å¿†ç®¡ç†ï¼ˆä¸“å®¶è¯„å®¡æŠ¥å‘Šç¬¬ 5.1 èŠ‚ï¼‰
class ConversationMemory:
    def __init__(self, max_turns=5):
        self.history = []

    def add_turn(self, question: str, answer: str, context: List[str]):
        self.history.append({
            "question": question,
            "answer": answer,
            "retrieved_docs": context,
            "timestamp": time.time()
        })

        # ä¿ç•™æœ€è¿‘ N è½®
        if len(self.history) > max_turns:
            self.history = self.history[-max_turns:]

    def build_context_prompt(self, new_question: str):
        # å‹ç¼©å†å²ä¸ºç®€æ´ä¸Šä¸‹æ–‡
        recent = self.history[-3:]
        context = "\n".join([
            f"Q: {turn['question']}\nA: {turn['answer']}"
            for turn in recent
        ])

        return f"å¯¹è¯å†å²ï¼š\n{context}\n\nå½“å‰é—®é¢˜ï¼š{new_question}"
```

**æ ¸å¿ƒå·®å¼‚**:
| ç»´åº¦ | å½“å‰å®ç° | Agentic RAG | å·®è· |
|-----|---------|------------|------|
| **å¯¹è¯å†å²** | æ—  | ä¿ç•™ 5 è½® | âŒ ç¼ºå¤± |
| **ä¸Šä¸‹æ–‡ç†è§£** | æ—  | è‡ªåŠ¨è¡¥å…… | âŒ ç¼ºå¤± |
| **ä»£è¯æ¶ˆæ­§** | æ—  | æ”¯æŒ | âŒ ç¼ºå¤± |
| **ä¼šè¯ç®¡ç†** | æ—  | æœ‰ conversation_id | âŒ ç¼ºå¤± |

### å·®è·è¯„ä¼°

**ğŸŸ¡ ä¸­ç­‰é—®é¢˜**:
1. **ç”¨æˆ·ä½“éªŒå·®**: æ— æ³•è¿›è¡Œè‡ªç„¶çš„è¿ç»­å¯¹è¯
2. **æ•ˆç‡ä½**: ç”¨æˆ·å¿…é¡»æ¯æ¬¡é‡å¤å®Œæ•´é—®é¢˜
3. **ä¸Šä¸‹æ–‡ä¸¢å¤±**: æ— æ³•è¿›è¡Œæ·±å…¥çš„è¿½é—®å’Œåˆ†æ

**ğŸ’¡ ä¼˜åŒ–å»ºè®®**:
```python
# å»ºè®®ï¼šæ·»åŠ å¯¹è¯è®°å¿†å±‚
@app.post("/chat/ask")
async def ask_question(request: QuestionRequest):
    conversation_id = request.conversation_id or generate_id()

    # è·å–æˆ–åˆ›å»ºå¯¹è¯è®°å¿†
    memory = get_conversation_memory(conversation_id)

    # æ„å»ºåŒ…å«å†å²çš„æç¤ºè¯
    if memory.history:
        context_prompt = memory.build_context_prompt(request.question)
    else:
        context_prompt = request.question

    # å¤„ç†é—®é¢˜
    answer = processor.process_question(context_prompt)

    # ä¿å­˜æœ¬è½®å¯¹è¯
    memory.add_turn(request.question, answer, retrieved_docs=[])

    return {
        "answer": answer,
        "conversation_id": conversation_id
    }
```

**å®æ–½ä¼˜å…ˆçº§**: ğŸŸ¡ **P1 - ä¸­ä¼˜å…ˆçº§**

**ç†ç”±**: æ˜¾è‘—æå‡ç”¨æˆ·ä½“éªŒï¼Œå®æ–½éš¾åº¦ä¸­ç­‰ï¼ˆ3-5å¤©ï¼‰ã€‚

---

## 6ï¸âƒ£ è¯„ä¼°æŒ‡æ ‡ä½“ç³»å¯¹æ¯”

### å½“å‰å®ç°

```python
# å½“å‰ï¼šæ— ç³»ç»ŸåŒ–è¯„ä¼°
# - æ— æ£€ç´¢è´¨é‡æŒ‡æ ‡
# - æ— ç”Ÿæˆè´¨é‡æŒ‡æ ‡
# - æ— æ€§èƒ½ç›‘æ§
# - æ—  A/B æµ‹è¯•æ¡†æ¶
```

**ç‰¹ç‚¹**:
- âŒ **æ— æ³•é‡åŒ–ç³»ç»Ÿæ•ˆæœ**ï¼šä¸çŸ¥é“å‡†ç¡®ç‡å¤šå°‘
- âŒ **æ— æ€§èƒ½ç›‘æ§**ï¼šä¸çŸ¥é“å“åº”æ—¶é—´åˆ†å¸ƒ
- âŒ **æ— æˆæœ¬è¿½è¸ª**ï¼šä¸çŸ¥é“ API èŠ±è´¹
- âŒ **æ— ä¼˜åŒ–ä¾æ®**ï¼šä¸çŸ¥é“å“ªé‡Œéœ€è¦æ”¹è¿›

### Agentic RAG æ–¹æ¡ˆ

```python
# å®Œæ•´è¯„ä¼°ä½“ç³»ï¼ˆä¸“å®¶è¯„å®¡æŠ¥å‘Šç¬¬ 5.4 èŠ‚ï¼‰
class RetrievalMetrics:
    @staticmethod
    def calculate_mrr(retrieved, relevant):
        """Mean Reciprocal Rank - æ­£ç¡®æ–‡æ¡£çš„å¹³å‡æ’å"""
        for i, doc in enumerate(retrieved, 1):
            if doc in relevant:
                return 1.0 / i
        return 0.0

    @staticmethod
    def calculate_recall_at_k(retrieved, relevant, k):
        """Recall@K - å‰ K ä¸ªç»“æœä¸­çš„å¬å›ç‡"""
        retrieved_k = retrieved[:k]
        hits = len(set(retrieved_k) & set(relevant))
        return hits / len(relevant) if relevant else 0.0

class GenerationMetrics:
    def calculate_faithfulness(self, answer, source_docs):
        """Faithfulness - ç­”æ¡ˆæ˜¯å¦å¿ äºæºæ–‡æ¡£"""
        # ä½¿ç”¨ LLM åˆ¤æ–­
        pass
```

**æ ¸å¿ƒå·®å¼‚**:
| ç»´åº¦ | å½“å‰å®ç° | Agentic RAG | å·®è· |
|-----|---------|------------|------|
| **æ£€ç´¢æŒ‡æ ‡** | æ—  | MRR/NDCG/Recall@K | âŒ ç¼ºå¤± |
| **ç”ŸæˆæŒ‡æ ‡** | æ—  | Faithfulness/Relevance | âŒ ç¼ºå¤± |
| **æ€§èƒ½æŒ‡æ ‡** | æ—  | P95 Latency/Throughput | âŒ ç¼ºå¤± |
| **æˆæœ¬æŒ‡æ ‡** | æ—  | Cost per Query | âŒ ç¼ºå¤± |
| **æµ‹è¯•æ•°æ®é›†** | æ—  | 100+ æ ‡å‡†é—®é¢˜ | âŒ ç¼ºå¤± |

### å·®è·è¯„ä¼°

**ğŸŸ¡ ä¸­ç­‰é—®é¢˜**:
1. **æ”¹è¿›ç›²ç›®**: ä¸çŸ¥é“å“ªä¸ªæ”¹åŠ¨æœ‰æ•ˆ
2. **æ— æ³•å¯¹æ¯”**: æ— æ³•æ¯”è¾ƒä¸åŒç­–ç•¥çš„æ•ˆæœ
3. **è´¨é‡ä¸å¯æ§**: æ— æ³•ä¿è¯ç³»ç»Ÿç¨³å®šæ€§

**ğŸ’¡ ä¼˜åŒ–å»ºè®®**:
```python
# å»ºè®®ï¼šå»ºç«‹æœ€å°å¯è¡Œè¯„ä¼°ä½“ç³»
class RAGEvaluator:
    def __init__(self, test_dataset_path: str):
        # å‡†å¤‡æµ‹è¯•æ•°æ®é›†
        self.test_questions = self._load_test_questions(test_dataset_path)

    def evaluate_system(self, pipeline: Pipeline):
        results = {
            "accuracy": 0,
            "avg_latency": 0,
            "cost_per_query": 0,
            "faithfulness": 0
        }

        for question in self.test_questions:
            start = time.time()

            # æ‰§è¡ŒæŸ¥è¯¢
            answer = pipeline.ask(question["text"])

            # è®¡ç®—æŒ‡æ ‡
            latency = time.time() - start
            is_correct = self._check_answer(answer, question["expected"])

            results["accuracy"] += is_correct
            results["avg_latency"] += latency

        # æ±‡æ€»
        results["accuracy"] /= len(self.test_questions)
        results["avg_latency"] /= len(self.test_questions)

        return results
```

**å®æ–½ä¼˜å…ˆçº§**: ğŸŸ¡ **P1 - ä¸­ä¼˜å…ˆçº§**

**ç†ç”±**: å¯¹ç³»ç»Ÿæ”¹è¿›è‡³å…³é‡è¦ï¼Œä½†ä¸å½±å“å½“å‰åŠŸèƒ½ã€‚

---

## 7ï¸âƒ£ å¯æ‰©å±•æ€§æ¶æ„å¯¹æ¯”

### å½“å‰å®ç°

```python
# src/ingestion.py - å½“å‰å‘é‡å­˜å‚¨
class VectorDBIngestor:
    def create_vector_db(self, embeddings, output_path):
        # ä½¿ç”¨æœ¬åœ° FAISS
        index = faiss.IndexFlatL2(dimension)
        index.add(embeddings)

        # å†™å…¥æœ¬åœ°æ–‡ä»¶ï¼ˆæœ‰ä¸­æ–‡è·¯å¾„é—®é¢˜ï¼‰
        faiss.write_index(index, str(output_path))
```

**ç‰¹ç‚¹**:
- âœ… æœ¬åœ° FAISS å·¥ä½œæ­£å¸¸
- âŒ **å•æœºé™åˆ¶**ï¼šæ‰€æœ‰æ•°æ®å¿…é¡»åŠ è½½åˆ°å†…å­˜
- âŒ **æ— åˆ†å¸ƒå¼**ï¼šæ— æ³•æ°´å¹³æ‰©å±•
- âŒ **å¹¶å‘å—é™**ï¼šå¤šç”¨æˆ·åŒæ—¶è®¿é—®æ€§èƒ½å·®
- âŒ **ä¸­æ–‡è·¯å¾„é—®é¢˜**ï¼šWindows ç³»ç»Ÿéœ€è¦ç‰¹æ®Šå¤„ç†

### Agentic RAG æ–¹æ¡ˆ

```python
# åˆ†å¸ƒå¼å‘é‡æ•°æ®åº“ï¼ˆä¸“å®¶è¯„å®¡æŠ¥å‘Šç¬¬ 5.5 èŠ‚ï¼‰
class VectorStoreAdapter:
    def __init__(self, store_type: str = "faiss"):
        if store_type == "faiss":
            self.store = FAISSStore()  # æœ¬åœ°å¼€å‘
        elif store_type == "qdrant":
            self.store = QdrantStore()  # ç”Ÿäº§ç¯å¢ƒ
        elif store_type == "milvus":
            self.store = MilvusStore()  # ä¼ä¸šçº§

    def search(self, query_vector, top_k=10):
        # ç»Ÿä¸€æ¥å£ï¼Œé€æ˜åˆ‡æ¢
        return self.store.search(query_vector, top_k)
```

**æ ¸å¿ƒå·®å¼‚**:
| ç»´åº¦ | å½“å‰å®ç° | Agentic RAG | å·®è· |
|-----|---------|------------|------|
| **å­˜å‚¨æ–¹å¼** | æœ¬åœ°æ–‡ä»¶ | åˆ†å¸ƒå¼æ•°æ®åº“ | âŒ å—é™ |
| **å¹¶å‘èƒ½åŠ›** | å•æœº (QPS<10) | é›†ç¾¤ (QPS>100) | âŒ å·¨å¤§å·®è· |
| **æ•°æ®è§„æ¨¡** | å—å†…å­˜é™åˆ¶ | å¯æ‰©å±•åˆ° TB çº§ | âŒ å—é™ |
| **é«˜å¯ç”¨** | æ—  | ä¸»ä»å¤åˆ¶ + æ•…éšœè½¬ç§» | âŒ ç¼ºå¤± |

### å·®è·è¯„ä¼°

**ğŸŸ¢ ä½ä¼˜å…ˆçº§é—®é¢˜**ï¼ˆå½“å‰è§„æ¨¡ä¸‹ï¼‰:
1. **å½“å‰å¤Ÿç”¨**: æŠ•ç ”æŠ¥å‘Šæ•°é‡ < 10,000 ä»½ï¼Œæœ¬åœ° FAISS è¶³å¤Ÿ
2. **æœªæ¥ç“¶é¢ˆ**: å¦‚æœæ‰©å±•åˆ° 100,000+ ä»½æ–‡æ¡£ï¼Œéœ€è¦åˆ†å¸ƒå¼
3. **æˆæœ¬è€ƒè™‘**: åˆ†å¸ƒå¼æ•°æ®åº“éœ€è¦é¢å¤–æœåŠ¡å™¨æˆæœ¬

**ğŸ’¡ ä¼˜åŒ–å»ºè®®**:
```python
# å»ºè®®ï¼šä¿ç•™ FAISSï¼Œä½†è®¾è®¡å¯æ‰©å±•æ¥å£
class VectorStore:
    """æŠ½è±¡å‘é‡å­˜å‚¨æ¥å£"""

    @abstractmethod
    def add(self, vectors, ids):
        pass

    @abstractmethod
    def search(self, query_vector, top_k):
        pass

class FAISSVectorStore(VectorStore):
    """æœ¬åœ° FAISS å®ç°"""
    pass

class QdrantVectorStore(VectorStore):
    """Qdrant äº‘æœåŠ¡å®ç°ï¼ˆæœªæ¥æ‰©å±•ï¼‰"""
    pass
```

**å®æ–½ä¼˜å…ˆçº§**: ğŸŸ¢ **P2 - ä½ä¼˜å…ˆçº§**

**ç†ç”±**: å½“å‰è§„æ¨¡ä¸‹ä¸æ˜¯ç“¶é¢ˆï¼Œå¯å»¶ååˆ°ä¸šåŠ¡å¢é•¿åå†è€ƒè™‘ã€‚

---

## ğŸ“Š ç»¼åˆå¯¹æ¯”æ€»ç»“è¡¨

| åŠŸèƒ½æ¨¡å— | å½“å‰æˆç†Ÿåº¦ | Agentic æˆç†Ÿåº¦ | å·®è·ç¨‹åº¦ | å®æ–½éš¾åº¦ | ä»·å€¼æ”¶ç›Š | ä¼˜å…ˆçº§ |
|---------|----------|---------------|---------|---------|---------|--------|
| **æ£€ç´¢ç­–ç•¥** | â­â­â­ æ ‡å‡† | â­â­â­â­â­ ä¼˜ç§€ | ğŸ”´ å¤§ | ğŸŸ¡ ä¸­ | â­â­â­â­â­ å¾ˆé«˜ | P0 |
| **æ™ºèƒ½è·¯ç”±** | â­ æ—  | â­â­â­â­â­ ä¼˜ç§€ | ğŸ”´ å¤§ | ğŸ”´ é«˜ | â­â­â­â­ é«˜ | P1 |
| **æˆæœ¬æ§åˆ¶** | â­ æ—  | â­â­â­â­â­ ä¼˜ç§€ | ğŸ”´ å·¨å¤§ | ğŸŸ¢ ä½ | â­â­â­â­â­ æé«˜ | P0 |
| **ç­”æ¡ˆéªŒè¯** | â­ æ—  | â­â­â­â­ è‰¯å¥½ | ğŸ”´ å¤§ | ğŸŸ¡ ä¸­ | â­â­â­â­ é«˜ | P0 |
| **å¤šè½®å¯¹è¯** | â­ æ—  | â­â­â­â­ è‰¯å¥½ | ğŸŸ¡ ä¸­ | ğŸŸ¡ ä¸­ | â­â­â­â­ é«˜ | P1 |
| **è¯„ä¼°ä½“ç³»** | â­ æ—  | â­â­â­â­ è‰¯å¥½ | ğŸŸ¡ ä¸­ | ğŸŸ¡ ä¸­ | â­â­â­ ä¸­ | P1 |
| **åˆ†å¸ƒå¼æ¶æ„** | â­â­ å•æœº | â­â­â­â­â­ é›†ç¾¤ | ğŸŸ¡ ä¸­ | ğŸ”´ é«˜ | â­â­â­ ä¸­ | P2 |

---

## ğŸ¯ ä¼˜åŒ–å®æ–½è·¯çº¿å›¾

### Phase 1: å¿«é€Ÿè§æ•ˆï¼ˆWeek 1-2ï¼‰- P0 ä¼˜å…ˆçº§

**ç›®æ ‡**: è§£å†³æˆæœ¬å’Œä¿¡ä»»åº¦é—®é¢˜ï¼Œç«‹ç«¿è§å½±çš„æ•ˆæœ

1. **æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿ** (2 å¤©)
   - å®æ–½ç²¾ç¡®ç¼“å­˜ï¼ˆRedisï¼‰
   - å®æ–½è¯­ä¹‰ç¼“å­˜ï¼ˆåŸºäº Embedding ç›¸ä¼¼åº¦ï¼‰
   - é¢„æœŸæ•ˆæœï¼šæˆæœ¬ -60%ï¼Œé€Ÿåº¦ +3x

2. **ç­”æ¡ˆéªŒè¯å™¨** (3 å¤©)
   - å¼•ç”¨å®Œæ•´æ€§æ£€æŸ¥
   - ç½®ä¿¡åº¦è¯„åˆ†
   - å‰ç«¯è­¦å‘Šæç¤º
   - é¢„æœŸæ•ˆæœï¼šç”¨æˆ·ä¿¡ä»»åº¦ +50%

3. **æˆæœ¬ç›‘æ§ä»ªè¡¨ç›˜** (2 å¤©)
   - API è°ƒç”¨ç»Ÿè®¡
   - æˆæœ¬å®æ—¶è¿½è¸ª
   - å¼‚å¸¸å‘Šè­¦
   - é¢„æœŸæ•ˆæœï¼šæˆæœ¬å¯æ§ã€å¯è§†åŒ–

**é¢„æœŸæŠ•å…¥**: 1 åå¼€å‘å·¥ç¨‹å¸ˆï¼Œ7 å¤©
**é¢„æœŸäº§å‡º**:
- API æˆæœ¬é™ä½ 60%
- å“åº”é€Ÿåº¦æå‡ 3 å€
- ç­”æ¡ˆå¯ä¿¡åº¦æ˜¾è‘—æå‡

---

### Phase 2: æ ¸å¿ƒèƒ½åŠ›å¢å¼ºï¼ˆWeek 3-5ï¼‰- P0/P1 ä¼˜å…ˆçº§

**ç›®æ ‡**: æå‡æ£€ç´¢å‡†ç¡®ç‡å’Œç”¨æˆ·ä½“éªŒ

4. **åˆ†å±‚å¯¼èˆªæ£€ç´¢** (5 å¤©)
   - ChunkNavigator ç±»å®ç°
   - é›†æˆåˆ° Pipeline
   - æ€§èƒ½å¯¹æ¯”æµ‹è¯•
   - é¢„æœŸæ•ˆæœï¼šé•¿æ–‡æ¡£æ£€ç´¢å‡†ç¡®ç‡ +10-15%

5. **å¤šè½®å¯¹è¯æ”¯æŒ** (4 å¤©)
   - ConversationMemory å®ç°
   - API æ¥å£è°ƒæ•´ï¼ˆæ·»åŠ  conversation_idï¼‰
   - å‰ç«¯å¯¹è¯å†å²å±•ç¤º
   - é¢„æœŸæ•ˆæœï¼šç”¨æˆ·ä½“éªŒ +40%

6. **æœ€å°è¯„ä¼°ä½“ç³»** (3 å¤©)
   - å‡†å¤‡æµ‹è¯•æ•°æ®é›†ï¼ˆ100 ä¸ªé—®é¢˜ï¼‰
   - å®æ–½ MRR/Recall@K è®¡ç®—
   - è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬
   - é¢„æœŸæ•ˆæœï¼šç³»ç»Ÿè´¨é‡å¯é‡åŒ–

**é¢„æœŸæŠ•å…¥**: 1-2 åå¼€å‘å·¥ç¨‹å¸ˆï¼Œ12 å¤©
**é¢„æœŸäº§å‡º**:
- æ£€ç´¢å‡†ç¡®ç‡æå‡ 10-15%
- æ”¯æŒè‡ªç„¶è¿ç»­å¯¹è¯
- å»ºç«‹è´¨é‡è¯„ä¼°åŸºå‡†

---

### Phase 3: é«˜çº§ä¼˜åŒ–ï¼ˆWeek 6-8ï¼‰- P1/P2 ä¼˜å…ˆçº§

**ç›®æ ‡**: è¿›ä¸€æ­¥æå‡æ™ºèƒ½åŒ–æ°´å¹³å’Œå¯æ‰©å±•æ€§

7. **æ™ºèƒ½è·¯ç”±ä»£ç†** (5 å¤©)
   - RoutingAgent ç±»å®ç°
   - å®¹é”™æœºåˆ¶
   - å¯è§£é‡Šæ€§å±•ç¤º
   - é¢„æœŸæ•ˆæœï¼šå‡†ç¡®ç‡ +8-12%ï¼Œå¯è§£é‡Šæ€§å¢å¼º

8. **åˆ†å±‚æ¨¡å‹è°ƒç”¨** (3 å¤©)
   - æŒ‰æ–‡æ¡£å¤§å°é€‰æ‹©ç­–ç•¥
   - qwen-turbo vs qwen-max è‡ªåŠ¨åˆ‡æ¢
   - é¢„æœŸæ•ˆæœï¼šåœ¨ä¿æŒå‡†ç¡®ç‡çš„æƒ…å†µä¸‹ï¼Œè¿›ä¸€æ­¥é™ä½æˆæœ¬ 20%

9. **å‘é‡å­˜å‚¨æŠ½è±¡å±‚** (3 å¤©)
   - VectorStore æ¥å£è®¾è®¡
   - FAISS / Qdrant åŒå®ç°
   - ä¸ºæœªæ¥æ‰©å±•åšå‡†å¤‡
   - é¢„æœŸæ•ˆæœï¼šæ¶æ„æ›´çµæ´»ï¼Œæ˜“äºæ‰©å±•

**é¢„æœŸæŠ•å…¥**: 2 åå¼€å‘å·¥ç¨‹å¸ˆï¼Œ11 å¤©
**é¢„æœŸäº§å‡º**:
- æ£€ç´¢æ™ºèƒ½åŒ–æ°´å¹³æ˜¾è‘—æå‡
- æˆæœ¬è¿›ä¸€æ­¥ä¼˜åŒ– 20%
- æ¶æ„æ”¯æŒæœªæ¥æ‰©å±•åˆ° 10ä¸‡+ æ–‡æ¡£

---

## ğŸ’° æˆæœ¬æ”¶ç›Šåˆ†æ

### æŠ•å…¥æˆæœ¬ä¼°ç®—

| é˜¶æ®µ | äººåŠ›æŠ•å…¥ | å·¥æœŸ | API æµ‹è¯•æˆæœ¬ | æ€»æˆæœ¬ |
|-----|---------|------|------------|--------|
| Phase 1 | 1 äºº Ã— 7 å¤© | 1-2 å‘¨ | Â¥200 | Â¥5,000 |
| Phase 2 | 1.5 äºº Ã— 12 å¤© | 3-5 å‘¨ | Â¥500 | Â¥12,000 |
| Phase 3 | 2 äºº Ã— 11 å¤© | 6-8 å‘¨ | Â¥300 | Â¥15,000 |
| **åˆè®¡** | **çº¦ 30 äººå¤©** | **8 å‘¨** | **Â¥1,000** | **Â¥32,000** |

### æ”¶ç›Šä¼°ç®—ï¼ˆå¹´åŒ–ï¼‰

| æ”¶ç›Šç±»å‹ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | èŠ‚çœ/æå‡ | å¹´åŒ–ä»·å€¼ |
|---------|-------|--------|---------|---------|
| **API æˆæœ¬** | Â¥6,000/æœˆ | Â¥2,400/æœˆ | -60% | **Â¥43,200** |
| **å“åº”é€Ÿåº¦** | 5 ç§’/æŸ¥è¯¢ | 1.5 ç§’/æŸ¥è¯¢ | +3x | ç”¨æˆ·ä½“éªŒâ†‘ |
| **å‡†ç¡®ç‡** | 85% | 95%+ | +10% | ä¿¡ä»»åº¦â†‘ |
| **å¹¶å‘èƒ½åŠ›** | 10 QPS | 30 QPS | +3x | å¯æ”¯æ’‘æ›´å¤šç”¨æˆ· |

**ROI åˆ†æ**:
- æŠ•å…¥ï¼šÂ¥32,000
- ç¬¬ä¸€å¹´æ”¶ç›Šï¼šÂ¥43,200ï¼ˆä»… API æˆæœ¬èŠ‚çœï¼‰
- **ROI**: 135%ï¼ˆç¬¬ä¸€å¹´å³å›æœ¬å¹¶ç›ˆåˆ©ï¼‰
- é™„åŠ ä»·å€¼ï¼šç”¨æˆ·ä½“éªŒã€å‡†ç¡®ç‡ã€å¯æ‰©å±•æ€§æ— æ³•é‡åŒ–ï¼Œä½†ä»·å€¼å·¨å¤§

---

## âš ï¸ é£é™©è¯„ä¼°ä¸ç¼“è§£

### æŠ€æœ¯é£é™©

| é£é™© | å½±å“ | æ¦‚ç‡ | ç¼“è§£æªæ–½ |
|-----|------|------|---------|
| **LLM è·¯ç”±ä¸ç¨³å®š** | æ£€ç´¢è´¨é‡ä¸‹é™ | ğŸŸ¡ ä¸­ | æ·»åŠ é™çº§æœºåˆ¶ï¼Œå¤±è´¥æ—¶å›é€€åˆ°ä¼ ç»Ÿæ£€ç´¢ |
| **ç¼“å­˜å¤±æ•ˆç­–ç•¥é”™è¯¯** | è¿”å›è¿‡æœŸç­”æ¡ˆ | ğŸŸ¢ ä½ | è®¾ç½®åˆç† TTLï¼Œæ”¯æŒæ‰‹åŠ¨åˆ·æ–° |
| **è¯„ä¼°æ•°æ®é›†è´¨é‡å·®** | è¯„ä¼°ç»“æœä¸å‡† | ğŸŸ¡ ä¸­ | äººå·¥å®¡æ ¸æµ‹è¯•é›†ï¼Œå®šæœŸæ›´æ–° |
| **åˆ†å±‚æ£€ç´¢æ€§èƒ½å·®** | å“åº”æ—¶é—´å¢åŠ  | ğŸŸ¢ ä½ | ä»…å¯¹å¤§æ–‡æ¡£å¯ç”¨ï¼Œå¯é…ç½®å¼€å…³ |

### ä¸šåŠ¡é£é™©

| é£é™© | å½±å“ | æ¦‚ç‡ | ç¼“è§£æªæ–½ |
|-----|------|------|---------|
| **ç”¨æˆ·ä¸é€‚åº”æ–°åŠŸèƒ½** | ä½¿ç”¨ç‡ä¸‹é™ | ğŸŸ¢ ä½ | ç°åº¦å‘å¸ƒï¼ŒA/B æµ‹è¯• |
| **æˆæœ¬èŠ‚çœä¸è¾¾é¢„æœŸ** | ROI é™ä½ | ğŸŸ¡ ä¸­ | å…ˆå°è§„æ¨¡æµ‹è¯•ï¼ŒéªŒè¯åæ¨å¹¿ |
| **ç³»ç»Ÿå¤æ‚åº¦å¢åŠ ** | ç»´æŠ¤æˆæœ¬å¢åŠ  | ğŸŸ¡ ä¸­ | å……åˆ†æ–‡æ¡£åŒ–ï¼Œæ¨¡å—åŒ–è®¾è®¡ |

### å®æ–½é£é™©

| é£é™© | å½±å“ | æ¦‚ç‡ | ç¼“è§£æªæ–½ |
|-----|------|------|---------|
| **å·¥æœŸå»¶è¯¯** | å»¶è¿Ÿä¸Šçº¿ | ğŸŸ¡ ä¸­ | åˆ†é˜¶æ®µå®æ–½ï¼Œä¼˜å…ˆ P0 |
| **äººå‘˜ä¸è¶³** | è´¨é‡ä¸‹é™ | ğŸŸ¢ ä½ | å¤–åŒ…æˆ–å»¶é•¿å·¥æœŸ |
| **æµ‹è¯•ä¸å……åˆ†** | ç”Ÿäº§æ•…éšœ | ğŸŸ¡ ä¸­ | å»ºç«‹æµ‹è¯•ç¯å¢ƒï¼Œå……åˆ†æµ‹è¯• |

---

## ğŸ“‹ æœ€ç»ˆå»ºè®®

### ç«‹å³å®æ–½ï¼ˆæœ¬å‘¨å†…ï¼‰

1. âœ… **æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿ** - æœ€å¿«è§æ•ˆï¼Œé£é™©æœ€ä½
   - å®æ–½ç²¾ç¡®ç¼“å­˜ï¼ˆ1 å¤©ï¼‰
   - å®æ–½è¯­ä¹‰ç¼“å­˜ï¼ˆ1 å¤©ï¼‰
   - éªŒè¯æ•ˆæœï¼ˆ0.5 å¤©ï¼‰

2. âœ… **æˆæœ¬ç›‘æ§** - äº†è§£å½“å‰æˆæœ¬åŸºçº¿
   - æ·»åŠ  API è°ƒç”¨æ—¥å¿—ï¼ˆ0.5 å¤©ï¼‰
   - ç®€å•çš„æˆæœ¬ç»Ÿè®¡ï¼ˆ0.5 å¤©ï¼‰

### ä¼˜å…ˆå®æ–½ï¼ˆ2 å‘¨å†…ï¼‰

3. âœ… **ç­”æ¡ˆéªŒè¯å™¨** - æå‡ä¿¡ä»»åº¦
4. âœ… **åˆ†å±‚å¯¼èˆªæ£€ç´¢** - æå‡å‡†ç¡®ç‡
5. âœ… **æœ€å°è¯„ä¼°ä½“ç³»** - å»ºç«‹è´¨é‡åŸºå‡†

### é€æ­¥å®æ–½ï¼ˆ1-2 æœˆå†…ï¼‰

6. ğŸŸ¡ **å¤šè½®å¯¹è¯æ”¯æŒ**
7. ğŸŸ¡ **æ™ºèƒ½è·¯ç”±ä»£ç†**
8. ğŸŸ¡ **åˆ†å±‚æ¨¡å‹è°ƒç”¨**

### å¯é€‰å®æ–½ï¼ˆæŒ‰éœ€ï¼‰

9. ğŸŸ¢ **åˆ†å¸ƒå¼æ¶æ„** - ä¸šåŠ¡å¢é•¿åå†è€ƒè™‘

---

## ğŸ“ åç»­æ”¯æŒ

**æ–‡æ¡£ç»´æŠ¤**: æœ¬è¯„ä¼°æŠ¥å‘Šåº”å®šæœŸæ›´æ–°ï¼ˆæ¯å­£åº¦ï¼‰
**æ•ˆæœè¿½è¸ª**: æ¯ä¸ªä¼˜åŒ–å®æ–½åï¼Œè®°å½•å®é™…æ•ˆæœä¸é¢„æœŸå¯¹æ¯”
**æŒç»­ä¼˜åŒ–**: æ ¹æ®å®é™…æ•°æ®åé¦ˆï¼Œè°ƒæ•´ä¼˜åŒ–ç­–ç•¥

**è”ç³»æ–¹å¼**: å¼€å‘å›¢é˜Ÿ
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2025-09-30

---

> ğŸ’¡ **æ ¸å¿ƒç»“è®º**: å½“å‰ç³»ç»ŸåŸºç¡€æ‰å®ï¼Œä½†åœ¨æˆæœ¬æ§åˆ¶ã€ç­”æ¡ˆéªŒè¯ã€æ™ºèƒ½æ£€ç´¢æ–¹é¢ä¸ Agentic RAG æœ‰æ˜æ˜¾å·®è·ã€‚é€šè¿‡åˆ†é˜¶æ®µå®æ–½ä¼˜åŒ–ï¼Œé¢„è®¡å¯åœ¨ 2 ä¸ªæœˆå†…å®ç°ï¼šæˆæœ¬é™ä½ 60%+ã€å‡†ç¡®ç‡æå‡ 10-15%ã€ç”¨æˆ·ä½“éªŒæ˜¾è‘—æ”¹å–„ã€‚æŠ•å…¥äº§å‡ºæ¯”ä¼˜ç§€ï¼Œå»ºè®®ç«‹å³å¯åŠ¨ Phase 1ã€‚
